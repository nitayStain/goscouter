{{ if .Error }}
  <div class="error">
    <strong>Scan failed.</strong> {{ .Error }}
  </div>
  <div class="empty-state">
    Check the domain and try again.
  </div>
{{ else }}
  <h2>Results for {{ .Domain }}</h2>
  <div class="grid" style="margin-bottom: 18px">
    <div class="stat">
      <span>Subdomains</span>
      <p>{{ .Count }}</p>
    </div>
    <div class="stat">
      <span>Wildcard DNS</span>
      <p>{{ if .HasWildcard }}Yes{{ else }}No{{ end }}</p>
    </div>
    <div class="stat">
      <span>Unique IPs</span>
      <p>{{ .UniqueIPs }}</p>
    </div>
    <div class="stat">
      <span>Cert issuers</span>
      <p>{{ .UniqueIssuers }}</p>
    </div>
  </div>

  {{ if eq .Count 0 }}
    <div class="empty-state">
      No subdomains discovered yet. Try another domain or rerun the scan.
    </div>
  {{ else }}
    <div class="results-list">
      {{ range .Items }}
        <div class="result-item">
          <strong>{{ .Name }}</strong>
          {{ if .IPs }}
            <span>IPs: {{ join .IPs ", " }}</span>
          {{ else }}
            <span>No resolved IPs.</span>
          {{ end }}
          {{ if .IPOwner }}
            <span>Owner: {{ .IPOwner }}</span>
          {{ end }}
          {{ if .CertIssuer }}
            <span>Issuer: {{ .CertIssuer }}</span>
          {{ end }}
          {{ if .CertExpiry }}
            <span>Expires: {{ .CertExpiry }}</span>
          {{ end }}
        </div>
      {{ end }}
    </div>
  {{ end }}
{{ end }}
